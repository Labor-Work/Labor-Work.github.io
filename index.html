<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labor Work - Visa Management System</title>
    
    <!-- Material-UI CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mui/material@5.14.0/umd/material-ui.min.css" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        :root {
            --labor-yellow: #FFD700;
            --labor-dark: #333333;
            --labor-light: #F5F5F5;
            --sidebar-width: 280px;
            --header-height: 64px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f5f5f5;
            overflow-x: hidden;
        }

        /* Login Screen Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #FFD700 0%, #FFA000 100%);
        }

        .login-card {
            background: white;
            padding: 48px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            margin: 20px;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 32px;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: var(--labor-yellow);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: var(--labor-dark);
            margin-bottom: 16px;
        }

        .company-name {
            font-size: 28px;
            font-weight: 500;
            color: var(--labor-dark);
        }

        /* Layout Styles */
        .app-container {
            display: flex;
            min-height: 100vh;
            background-color: #f5f5f5;
        }

        .sidebar {
            width: var(--sidebar-width);
            background: white;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            background: var(--labor-yellow);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sidebar-logo {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--labor-dark);
        }

        .sidebar-nav {
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 24px;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            gap: 12px;
        }

        .nav-item:hover {
            background: #f5f5f5;
            color: var(--labor-dark);
        }

        .nav-item.active {
            background: #fff8dc;
            color: var(--labor-dark);
            border-left: 4px solid var(--labor-yellow);
        }

        .nav-item .material-icons {
            font-size: 20px;
        }

        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
            transition: margin-left 0.3s ease;
        }

        .header {
            background: white;
            padding: 16px 24px;
            margin-bottom: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 24px;
            font-weight: 500;
            color: var(--labor-dark);
        }

        .header-actions {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            color: var(--labor-dark);
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-icon.yellow {
            background: #fff8dc;
            color: var(--labor-yellow);
        }

        .stat-icon.blue {
            background: #e3f2fd;
            color: #2196f3;
        }

        .stat-icon.green {
            background: #e8f5e9;
            color: #4caf50;
        }

        .stat-icon.red {
            background: #ffebee;
            color: #f44336;
        }

        .stat-content h3 {
            font-size: 28px;
            font-weight: 500;
            color: var(--labor-dark);
            margin-bottom: 4px;
        }

        .stat-content p {
            color: #666;
            font-size: 14px;
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: #fafafa;
        }

        .data-table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid #f0f0f0;
            font-size: 14px;
        }

        .data-table td {
            padding: 16px;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-table tbody tr:hover {
            background: #fafafa;
        }

        /* Status Badge */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-badge.active {
            background: #e8f5e9;
            color: #4caf50;
        }

        .status-badge.inactive {
            background: #ffebee;
            color: #f44336;
        }

        .status-badge.pending {
            background: #fff8dc;
            color: #ff9800;
        }

        .status-badge.completed {
            background: #e8f5e9;
            color: #4caf50;
        }

        .status-badge.in-progress {
            background: #e3f2fd;
            color: #2196f3;
        }

        /* Button Styles */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--labor-yellow);
            color: var(--labor-dark);
        }

        .btn-primary:hover {
            background: #FFC700;
            box-shadow: 0 2px 8px rgba(255,215,0,0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--labor-dark);
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #f5f5f5;
        }

        .btn-icon {
            background: transparent;
            padding: 8px;
            min-width: auto;
        }

        .btn-icon:hover {
            background: #f5f5f5;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--labor-dark);
            font-weight: 500;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--labor-yellow);
            box-shadow: 0 0 0 3px rgba(255,215,0,0.1);
        }

        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal {
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 500;
            color: var(--labor-dark);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Wizard Steps */
        .wizard-steps {
            display: flex;
            margin-bottom: 32px;
            border-bottom: 1px solid #eee;
        }

        .wizard-step {
            flex: 1;
            padding: 16px;
            text-align: center;
            position: relative;
            cursor: pointer;
        }

        .wizard-step.active {
            border-bottom: 3px solid var(--labor-yellow);
        }

        .wizard-step.completed {
            color: #4caf50;
        }

        .step-number {
            display: inline-block;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #ddd;
            color: white;
            line-height: 32px;
            margin-bottom: 8px;
        }

        .wizard-step.active .step-number {
            background: var(--labor-yellow);
            color: var(--labor-dark);
        }

        .wizard-step.completed .step-number {
            background: #4caf50;
        }

        /* Responsive Styles */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: white;
            border: none;
            padding: 8px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }

            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 60px 16px 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .login-card {
                padding: 32px 24px;
            }

            .data-table {
                font-size: 14px;
            }

            .data-table th,
            .data-table td {
                padding: 8px;
            }

            .modal {
                margin: 20px;
            }
        }

        /* Screen-specific styles */
        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* Grid layouts */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .employee-card {
            background: white;
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .employee-card:hover {
            border-color: #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .employee-card.selected {
            border-color: var(--labor-yellow);
            background: #fff8dc;
        }

        .employee-photo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #ddd;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #666;
        }

        /* Tab navigation */
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 24px;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab:hover {
            color: var(--labor-dark);
        }

        .tab.active {
            color: var(--labor-dark);
            border-bottom-color: var(--labor-yellow);
        }

        /* File upload area */
        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 48px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: var(--labor-yellow);
            background: #fff8dc;
        }

        .upload-area.dragover {
            border-color: var(--labor-yellow);
            background: #fff8dc;
        }

        .upload-icon {
            font-size: 48px;
            color: #999;
            margin-bottom: 16px;
        }

        /* Calendar styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-header {
            padding: 8px;
            text-align: center;
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 1px solid #eee;
            padding: 8px;
            cursor: pointer;
            position: relative;
            background: white;
        }

        .calendar-day:hover {
            background: #f5f5f5;
        }

        .calendar-day.selected {
            background: #fff8dc;
            border-color: var(--labor-yellow);
        }

        .calendar-day-number {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .calendar-event {
            font-size: 11px;
            background: var(--labor-yellow);
            color: var(--labor-dark);
            padding: 2px 4px;
            border-radius: 2px;
            margin-top: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Action buttons in tables */
        .table-actions {
            display: flex;
            gap: 8px;
        }

        /* Search bar */
        .search-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 10px 16px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        /* Filter chips */
        .filter-chips {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background: #f5f5f5;
            border-radius: 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chip:hover {
            background: #eee;
        }

        .chip.active {
            background: var(--labor-yellow);
            color: var(--labor-dark);
        }

        /* Progress bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--labor-yellow);
            transition: width 0.3s ease;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 48px;
            color: #999;
        }

        .empty-state .material-icons {
            font-size: 72px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Loading spinner */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 48px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--labor-yellow);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            animation: slideInRight 0.3s ease;
            border-left: 4px solid #4caf50;
        }

        .toast.error {
            border-left-color: #f44336;
        }

        .toast.warning {
            border-left-color: #ff9800;
        }

        .toast.info {
            border-left-color: #2196f3;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Confirmation dialog */
        .confirm-dialog {
            max-width: 400px;
        }

        .confirm-content {
            text-align: center;
            padding: 20px 0;
        }

        .confirm-icon {
            font-size: 48px;
            color: #ff9800;
            margin-bottom: 16px;
        }

        .confirm-message {
            font-size: 16px;
            color: var(--labor-dark);
            margin-bottom: 8px;
        }

        .confirm-details {
            font-size: 14px;
            color: #666;
        }

        /* Overlay for loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2500;
        }

        /* Bulk actions toolbar */
        .bulk-actions {
            background: #f5f5f5;
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            display: none;
            align-items: center;
            justify-content: space-between;
        }

        .bulk-actions.show {
            display: flex;
        }

        /* Preview pane */
        .preview-pane {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 16px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }

        /* File upload preview */
        .file-preview {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 6px;
            margin-top: 12px;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: var(--labor-yellow);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--labor-dark);
        }

        /* Dropdown menus */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: 6px;
            z-index: 1000;
            overflow: hidden;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dropdown-item:hover {
            background: #f5f5f5;
        }

        /* Stepper progress */
        .stepper-progress {
            width: 100%;
            height: 4px;
            background: #eee;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .stepper-fill {
            height: 100%;
            background: var(--labor-yellow);
            width: 25%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-card">
                <div class="logo-container">
                    <div class="logo">LW</div>
                    <h1 class="company-name">Labor Work</h1>
                    <p style="color: #666; margin-top: 8px;">Visa Management System</p>
                </div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" id="username" placeholder="Enter your username" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" placeholder="Enter your password" required>
                    </div>
                    
                    <div class="form-group" style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="remember" style="width: auto;">
                        <label for="remember" style="margin: 0; color: #666; font-size: 14px;">Remember me</label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 16px;">
                        <i class="material-icons">login</i>
                        Sign In
                    </button>
                    
                    <div style="text-align: center; margin-top: 16px;">
                        <a href="#" style="color: #666; font-size: 14px;">Forgot password?</a>
                    </div>
                </form>
                
                <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #eee; font-size: 12px; color: #999;">
                    <p><strong>Demo Credentials:</strong></p>
                    <p>Admin: admin / admin123</p>
                    <p>Staff: staff / staff123</p>
                    <p>Agent: agent / agent123</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="screen">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" onclick="toggleSidebar()">
            <i class="material-icons">menu</i>
        </button>

        <div class="app-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-logo">LW</div>
                    <div>
                        <div style="font-weight: 500;">Labor Work</div>
                        <div style="font-size: 12px; opacity: 0.8;">Visa Management</div>
                    </div>
                </div>
                
                <nav class="sidebar-nav" id="sidebarNav">
                    <!-- Navigation items will be inserted dynamically based on role -->
                </nav>
                
                <div style="padding: 20px; border-top: 1px solid #eee; margin-top: auto;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: #ddd; display: flex; align-items: center; justify-content: center;">
                            <i class="material-icons" style="color: #666;">person</i>
                        </div>
                        <div>
                            <div style="font-weight: 500;" id="currentUserName">John Admin</div>
                            <div style="font-size: 12px; color: #666;" id="currentUserRole">Administrator</div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" style="width: 100%;" onclick="logout()">
                        <i class="material-icons">logout</i>
                        Logout
                    </button>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content">
                <!-- Dynamic content will be loaded here -->
                <div id="contentArea"></div>
            </main>
        </div>

        <!-- Toast Notifications Container -->
        <div id="toastContainer" class="toast-container"></div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading">
                <div class="spinner"></div>
                <div style="margin-left: 16px;">Processing...</div>
            </div>
        </div>

        <!-- Modals -->
        <!-- Confirmation Dialog -->
        <div id="confirmDialog" class="modal-backdrop">
            <div class="modal confirm-dialog">
                <div class="modal-body">
                    <div class="confirm-content">
                        <i class="material-icons confirm-icon">warning</i>
                        <div class="confirm-message" id="confirmMessage">Are you sure?</div>
                        <div class="confirm-details" id="confirmDetails">This action cannot be undone.</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeConfirmDialog()">Cancel</button>
                    <button class="btn btn-primary" id="confirmButton" style="background: #f44336;" onclick="executeConfirmedAction()">Delete</button>
                </div>
            </div>
        </div>

        <!-- Create User Modal -->
        <div id="createUserModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Create New User</h2>
                    <button class="btn btn-icon" onclick="closeModal('createUserModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="createUserForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" name="fullName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" name="email" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Role</label>
                                <select class="form-control" name="role" required>
                                    <option value="">Select Role</option>
                                    <option value="admin">Administrator</option>
                                    <option value="staff">Staff</option>
                                    <option value="agent">Agent</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" name="password" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Confirm Password</label>
                                <input type="password" class="form-control" name="confirmPassword" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('createUserModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="createUser()">Create User</button>
                </div>
            </div>
        </div>

        <!-- Create Job Modal (Multi-step Wizard) -->
        <div id="createJobModal" class="modal-backdrop">
            <div class="modal" style="max-width: 800px;">
                <div class="modal-header">
                    <h2 class="modal-title">Create New Job</h2>
                    <button class="btn btn-icon" onclick="closeModal('createJobModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="wizard-steps">
                        <div class="wizard-step active" id="jobStep1">
                            <div class="step-number">1</div>
                            <div>Job Details</div>
                        </div>
                        <div class="wizard-step" id="jobStep2">
                            <div class="step-number">2</div>
                            <div>Template Selection</div>
                        </div>
                        <div class="wizard-step" id="jobStep3">
                            <div class="step-number">3</div>
                            <div>Employee Import</div>
                        </div>
                        <div class="wizard-step" id="jobStep4">
                            <div class="step-number">4</div>
                            <div>Review & Create</div>
                        </div>
                    </div>

                    <!-- Step 1: Job Details -->
                    <div id="jobStepContent1" class="wizard-content">
                        <form id="jobDetailsForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Job Name</label>
                                    <input type="text" class="form-control" name="jobName" placeholder="e.g., TechCorp Visa Processing" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Agent (Customer)</label>
                                    <select class="form-control" name="agent" required>
                                        <option value="">Select Agent</option>
                                        <option value="1">TechCorp Solutions</option>
                                        <option value="2">Global Industries</option>
                                        <option value="3">Metro Services</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Priority</label>
                                    <select class="form-control" name="priority">
                                        <option value="normal">Normal</option>
                                        <option value="high">High</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Due Date</label>
                                    <input type="date" class="form-control" name="dueDate">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" name="description" rows="3" placeholder="Enter job description..."></textarea>
                            </div>
                        </form>
                    </div>

                    <!-- Step 2: Template Selection -->
                    <div id="jobStepContent2" class="wizard-content" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Select Template</label>
                            <div style="display: grid; gap: 12px;">
                                <label class="template-option" style="display: flex; align-items: center; padding: 16px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer;">
                                    <input type="radio" name="template" value="1" style="margin-right: 12px;">
                                    <div>
                                        <div style="font-weight: 500;">Employment Chain Process</div>
                                        <div style="font-size: 14px; color: #666;">2 Forms - Visa Application, Employment Verification</div>
                                    </div>
                                </label>
                                <label class="template-option" style="display: flex; align-items: center; padding: 16px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer;">
                                    <input type="radio" name="template" value="2" style="margin-right: 12px;">
                                    <div>
                                        <div style="font-weight: 500;">Renewal Process</div>
                                        <div style="font-size: 14px; color: #666;">3 Forms - Renewal Application, Current Status, Medical Check</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Employee Import -->
                    <div id="jobStepContent3" class="wizard-content" style="display: none;">
                        <div class="upload-area" id="employeeUploadArea">
                            <i class="material-icons upload-icon">cloud_upload</i>
                            <h3>Upload Employee Data</h3>
                            <p style="color: #666;">Drag and drop ZIP file here or click to browse</p>
                            <p style="font-size: 12px; color: #999;">ZIP should contain passport copies, work permits, and photos</p>
                            <input type="file" id="employeeFileInput" accept=".zip" style="display: none;">
                        </div>
                        <div id="uploadProgress" style="display: none; margin-top: 20px;">
                            <p>Uploading and processing...</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Review -->
                    <div id="jobStepContent4" class="wizard-content" style="display: none;">
                        <div class="card" style="box-shadow: none; border: 1px solid #eee;">
                            <h3 style="margin-bottom: 16px;">Job Summary</h3>
                            <div id="jobSummary">
                                <!-- Summary will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="jobWizardBack" onclick="jobWizardBack()" style="display: none;">Back</button>
                    <button class="btn btn-primary" id="jobWizardNext" onclick="jobWizardNext()">Next</button>
                    <button class="btn btn-primary" id="jobWizardCreate" onclick="createJob()" style="display: none;">Create Job</button>
                </div>
            </div>
        </div>

        <!-- Edit User Modal -->
        <div id="editUserModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Edit User</h2>
                    <button class="btn btn-icon" onclick="closeModal('editUserModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editUserForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="editUserName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="editUserEmail" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" id="editUserPhone" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Role</label>
                                <select class="form-control" id="editUserRole" required>
                                    <option value="admin">Administrator</option>
                                    <option value="staff">Staff</option>
                                    <option value="agent">Agent</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-control" id="editUserStatus" required>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('editUserModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="updateUser()">Update User</button>
                </div>
            </div>
        </div>

        <!-- View User Details Modal -->
        <div id="viewUserModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">User Details</h2>
                    <button class="btn btn-icon" onclick="closeModal('viewUserModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="userDetailsContent">
                        <!-- Content will be populated dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('viewUserModal')">Close</button>
                    <button class="btn btn-primary" onclick="editUserFromView()">Edit User</button>
                </div>
            </div>
        </div>

        <!-- Employee Details Modal -->
        <div id="employeeDetailsModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Employee Details</h2>
                    <button class="btn btn-icon" onclick="closeModal('employeeDetailsModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="employeeDetailsContent">
                        <!-- Content will be populated dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('employeeDetailsModal')">Close</button>
                    <button class="btn btn-primary" onclick="editEmployeeFromView()">Edit Employee</button>
                </div>
            </div>
        </div>

        <!-- Form Preview Modal -->
        <div id="formPreviewModal" class="modal-backdrop">
            <div class="modal" style="max-width: 800px;">
                <div class="modal-header">
                    <h2 class="modal-title">Form Preview</h2>
                    <button class="btn btn-icon" onclick="closeModal('formPreviewModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="tabs">
                        <div class="tab active" onclick="switchPreviewTab('rendered')">Rendered Form</div>
                        <div class="tab" onclick="switchPreviewTab('json')">JSON Schema</div>
                    </div>
                    <div id="formPreviewContent">
                        <!-- Content will be populated dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('formPreviewModal')">Close</button>
                </div>
            </div>
        </div>

        <!-- Assignment Details Modal -->
        <div id="assignmentDetailsModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Assignment Details</h2>
                    <button class="btn btn-icon" onclick="closeModal('assignmentDetailsModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="assignmentDetailsContent">
                        <!-- Content will be populated dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('assignmentDetailsModal')">Close</button>
                    <button class="btn btn-primary" onclick="updateAssignmentStatus()">Update Status</button>
                </div>
            </div>
        </div>

        <!-- Bulk Actions Modal -->
        <div id="bulkActionsModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Bulk Operations</h2>
                    <button class="btn btn-icon" onclick="closeModal('bulkActionsModal')">
                        <i class="material-icons">close</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Select Action</label>
                        <select class="form-control" id="bulkActionType">
                            <option value="">Choose action...</option>
                            <option value="status">Update Status</option>
                            <option value="delete">Delete Selected</option>
                            <option value="export">Export Selected</option>
                            <option value="assign">Assign to Staff</option>
                        </select>
                    </div>
                    <div id="bulkActionOptions">
                        <!-- Options will be populated based on selected action -->
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: #f5f5f5; border-radius: 6px;">
                        <span id="bulkSelectedCount">0</span> items selected
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('bulkActionsModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="executeBulkAction()">Execute</button>
                </div>
            </div>
        </div>

        <!-- File Upload Progress Modal -->
        <div id="uploadProgressModal" class="modal-backdrop">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">File Upload</h2>
                </div>
                <div class="modal-body">
                    <div id="uploadProgressContent">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <i class="material-icons" style="font-size: 48px; color: var(--labor-yellow);">cloud_upload</i>
                            <div style="margin-top: 12px; font-weight: 500;">Uploading files...</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="uploadProgressBar" style="width: 0%"></div>
                        </div>
                        <div style="margin-top: 12px; text-align: center;">
                            <span id="uploadProgressText">0% Complete</span>
                        </div>
                        <div id="uploadResults" style="margin-top: 20px; display: none;">
                            <!-- Upload results will be shown here -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="uploadProgressFooter" style="display: none;">
                    <button class="btn btn-secondary" onclick="closeModal('uploadProgressModal')">Close</button>
                    <button class="btn btn-primary" onclick="processUploadedData()">Continue</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Demo data with expanded information
        let appData = {
            users: [
                { 
                    id: 1, 
                    name: "John Admin", 
                    email: "admin@laborwork.com", 
                    phone: "+1-555-0101",
                    role: "admin", 
                    status: "active",
                    lastLogin: "2025-01-18 09:30:00",
                    created: "2024-12-01"
                },
                { 
                    id: 2, 
                    name: "Sarah Staff", 
                    email: "sarah@laborwork.com", 
                    phone: "+1-555-0102",
                    role: "staff", 
                    status: "active",
                    lastLogin: "2025-01-18 10:45:00",
                    created: "2024-12-05"
                },
                { 
                    id: 3, 
                    name: "Mike Staff", 
                    email: "mike@laborwork.com", 
                    phone: "+1-555-0103",
                    role: "staff", 
                    status: "active",
                    lastLogin: "2025-01-18 08:15:00",
                    created: "2024-12-10"
                },
                { 
                    id: 4, 
                    name: "TechCorp Agent", 
                    email: "agent@techcorp.com", 
                    phone: "+1-555-0201",
                    role: "agent", 
                    status: "active",
                    lastLogin: "2025-01-18 11:20:00",
                    created: "2024-12-15"
                },
                { 
                    id: 5, 
                    name: "Global Agent", 
                    email: "agent@global.com", 
                    phone: "+1-555-0202",
                    role: "agent", 
                    status: "inactive",
                    lastLogin: "2025-01-15 16:30:00",
                    created: "2024-12-20"
                }
            ],
            jobs: [
                { 
                    id: 1, 
                    name: "TechCorp Visa Processing", 
                    agent: "TechCorp Solutions", 
                    template: "Employment Chain", 
                    status: "in-progress", 
                    employees: 15, 
                    created: "2025-01-10",
                    priority: "high",
                    dueDate: "2025-02-15",
                    description: "Process visa applications for TechCorp new hires"
                },
                { 
                    id: 2, 
                    name: "Global Industries Renewal", 
                    agent: "Global Industries", 
                    template: "Renewal Process", 
                    status: "pending", 
                    employees: 8, 
                    created: "2025-01-12",
                    priority: "normal",
                    dueDate: "2025-02-28",
                    description: "Renewal applications for existing employees"
                },
                { 
                    id: 3, 
                    name: "Metro Services New Hires", 
                    agent: "Metro Services", 
                    template: "Employment Chain", 
                    status: "completed", 
                    employees: 5, 
                    created: "2025-01-05",
                    priority: "normal",
                    dueDate: "2025-01-30",
                    description: "Completed visa processing for Metro Services"
                }
            ],
            employees: [
                { 
                    id: 1, 
                    name: "Alice Johnson", 
                    passport: "A1234567", 
                    job: "TechCorp Visa Processing", 
                    status: "pending",
                    nationality: "American",
                    position: "Software Engineer",
                    email: "alice.johnson@techcorp.com",
                    phone: "+1-555-1001"
                },
                { 
                    id: 2, 
                    name: "Bob Smith", 
                    passport: "B2345678", 
                    job: "TechCorp Visa Processing", 
                    status: "submitted",
                    nationality: "Canadian",
                    position: "Data Analyst",
                    email: "bob.smith@techcorp.com",
                    phone: "+1-555-1002"
                },
                { 
                    id: 3, 
                    name: "Carol Williams", 
                    passport: "C3456789", 
                    job: "TechCorp Visa Processing", 
                    status: "approved",
                    nationality: "British",
                    position: "Project Manager",
                    email: "carol.williams@techcorp.com",
                    phone: "+1-555-1003"
                },
                { 
                    id: 4, 
                    name: "David Brown", 
                    passport: "D4567890", 
                    job: "Global Industries Renewal", 
                    status: "pending",
                    nationality: "Australian",
                    position: "Marketing Director",
                    email: "david.brown@global.com",
                    phone: "+1-555-2001"
                },
                { 
                    id: 5, 
                    name: "Emma Davis", 
                    passport: "E5678901", 
                    job: "Metro Services New Hires", 
                    status: "approved",
                    nationality: "German",
                    position: "Operations Manager",
                    email: "emma.davis@metro.com",
                    phone: "+1-555-3001"
                }
            ],
            forms: [
                { 
                    id: 1, 
                    name: "Visa Application Form", 
                    description: "Standard visa application", 
                    status: "active", 
                    created: "2025-01-01",
                    version: 1,
                    fields: 15
                },
                { 
                    id: 2, 
                    name: "Employment Verification Form", 
                    description: "Employment details verification", 
                    status: "active", 
                    created: "2025-01-01",
                    version: 2,
                    fields: 12
                },
                { 
                    id: 3, 
                    name: "Medical Check Form", 
                    description: "Health examination results", 
                    status: "active", 
                    created: "2025-01-02",
                    version: 1,
                    fields: 8
                }
            ],
            templates: [
                { 
                    id: 1, 
                    name: "Employment Chain Process", 
                    forms: ["Visa Application Form", "Employment Verification Form"], 
                    agent: "All", 
                    status: "active",
                    created: "2025-01-01",
                    description: "Standard employment visa process"
                },
                { 
                    id: 2, 
                    name: "Renewal Process", 
                    forms: ["Renewal Application", "Current Status", "Medical Check"], 
                    agent: "All", 
                    status: "active",
                    created: "2025-01-02",
                    description: "Visa renewal workflow"
                }
            ],
            assignments: [
                { 
                    id: 1, 
                    staff: "Sarah Staff", 
                    employees: 5, 
                    office: "North Government Office", 
                    date: "2025-01-20", 
                    time: "09:00 AM", 
                    status: "scheduled",
                    instructions: "Bring all passport copies and stamped forms",
                    employeeList: ["Alice Johnson", "Bob Smith", "Carol Williams", "David Brown", "Emma Davis"]
                },
                { 
                    id: 2, 
                    staff: "Mike Staff", 
                    employees: 3, 
                    office: "South Government Office", 
                    date: "2025-01-20", 
                    time: "02:00 PM", 
                    status: "scheduled",
                    instructions: "Renewal documents required",
                    employeeList: ["Alice Johnson", "Bob Smith", "Carol Williams"]
                },
                { 
                    id: 3, 
                    staff: "Sarah Staff", 
                    employees: 4, 
                    office: "Central Office", 
                    date: "2025-01-19", 
                    time: "10:00 AM", 
                    status: "completed",
                    instructions: "Completed successfully",
                    employeeList: ["Emma Davis", "David Brown", "Alice Johnson", "Bob Smith"]
                }
            ]
        };

        // Demo data for templates, jobs, employees, and assignments
        const demoData = {
            templates: [
                {
                    id: 1,
                    name: "Safety Compliance Checklist",
                    forms: ["Safety Equipment Check", "Site Hazard Assessment", "Emergency Procedures"],
                    agent: "TechCorp Solutions",
                    status: "active"
                },
                {
                    id: 2,
                    name: "Quality Assurance Form",
                    forms: ["Quality Standards", "Inspection Report", "Defect Log"],
                    agent: "Global Industries",
                    status: "active"
                },
                {
                    id: 3,
                    name: "Daily Work Report",
                    forms: ["Work Summary", "Hours Logged", "Materials Used"],
                    agent: "Metro Services",
                    status: "draft"
                }
            ],
            jobs: appData.jobs,
            employees: appData.employees,
            assignments: appData.assignments
        };

        // Global state variables
        let currentUser = null;
        let currentScreen = 'dashboard';
        let jobWizardStep = 1;
        let selectedItems = [];
        let currentEditingItem = null;
        let pendingConfirmAction = null;

        // Utility functions
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? 'check_circle' : 
                        type === 'error' ? 'error' : 
                        type === 'warning' ? 'warning' : 'info';
            
            toast.innerHTML = `
                <i class="material-icons">${icon}</i>
                <span>${message}</span>
                <button class="btn btn-icon" onclick="this.parentElement.remove()" style="margin-left: auto;">
                    <i class="material-icons">close</i>
                </button>
            `;
            
            container.appendChild(toast);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }

        function showLoading(show = true) {
            document.getElementById('loadingOverlay').style.display = show ? 'flex' : 'none';
        }

        function showConfirmDialog(message, details, action, buttonText = 'Delete') {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmDetails').textContent = details;
            document.getElementById('confirmButton').textContent = buttonText;
            document.getElementById('confirmButton').style.background = 
                buttonText === 'Delete' ? '#f44336' : 'var(--labor-yellow)';
            pendingConfirmAction = action;
            openModal('confirmDialog');
        }

        function closeConfirmDialog() {
            closeModal('confirmDialog');
            pendingConfirmAction = null;
        }

        function executeConfirmedAction() {
            if (pendingConfirmAction) {
                pendingConfirmAction();
                closeConfirmDialog();
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        function generateId() {
            return Math.max(...Object.values(appData).flat().map(item => item.id || 0)) + 1;
        }

        // Data persistence
        function saveData() {
            localStorage.setItem('laborWorkData', JSON.stringify(appData));
        }

        function loadData() {
            const saved = localStorage.getItem('laborWorkData');
            if (saved) {
                appData = JSON.parse(saved);
            }
        }

        // Search and filter functions
        function filterTable(searchTerm, filterColumn = '', filterValue = '') {
            const table = document.querySelector('.data-table tbody');
            if (!table) return;

            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                let matchesSearch = false;
                let matchesFilter = true;

                // Check search term
                if (!searchTerm) {
                    matchesSearch = true;
                } else {
                    cells.forEach(cell => {
                        if (cell.textContent.toLowerCase().includes(searchTerm.toLowerCase())) {
                            matchesSearch = true;
                        }
                    });
                }

                // Check filter
                if (filterColumn && filterValue) {
                    const filterIndex = Array.from(row.parentElement.parentElement.querySelectorAll('th'))
                        .findIndex(th => th.textContent.toLowerCase().includes(filterColumn.toLowerCase()));
                    if (filterIndex >= 0 && cells[filterIndex]) {
                        matchesFilter = cells[filterIndex].textContent.toLowerCase().includes(filterValue.toLowerCase());
                    }
                }

                row.style.display = (matchesSearch && matchesFilter) ? '' : 'none';
            });
        }

        // Checkbox handling
        function toggleSelectAll(checkbox) {
            const checkboxes = document.querySelectorAll('.data-table tbody input[type="checkbox"]');
            checkboxes.forEach(cb => {
                cb.checked = checkbox.checked;
                toggleRowSelection(cb);
            });
            updateBulkActions();
        }

        function toggleRowSelection(checkbox) {
            const row = checkbox.closest('tr');
            const itemId = parseInt(checkbox.getAttribute('data-id'));
            
            if (checkbox.checked) {
                row.classList.add('selected');
                if (!selectedItems.includes(itemId)) {
                    selectedItems.push(itemId);
                }
            } else {
                row.classList.remove('selected');
                selectedItems = selectedItems.filter(id => id !== itemId);
            }
        }

        function updateBulkActions() {
            const bulkActions = document.querySelector('.bulk-actions');
            const selectedCount = document.getElementById('bulkSelectedCount');
            
            if (bulkActions) {
                if (selectedItems.length > 0) {
                    bulkActions.classList.add('show');
                    if (selectedCount) selectedCount.textContent = selectedItems.length;
                } else {
                    bulkActions.classList.remove('show');
                }
            }
        }

        // CRUD Operations for Users
        function deleteUser(userId) {
            const user = appData.users.find(u => u.id === userId);
            if (!user) return;

            showConfirmDialog(
                `Delete user "${user.name}"?`,
                'This action cannot be undone. All associated data will be removed.',
                () => {
                    showLoading(true);
                    setTimeout(() => {
                        appData.users = appData.users.filter(u => u.id !== userId);
                        saveData();
                        showLoading(false);
                        showToast(`User "${user.name}" has been deleted.`);
                        loadScreen('users');
                    }, 1000);
                }
            );
        }

        function editUser(userId) {
            const user = appData.users.find(u => u.id === userId);
            if (!user) return;

            currentEditingItem = user;
            document.getElementById('editUserName').value = user.name;
            document.getElementById('editUserEmail').value = user.email;
            document.getElementById('editUserPhone').value = user.phone;
            document.getElementById('editUserRole').value = user.role;
            document.getElementById('editUserStatus').value = user.status;
            openModal('editUserModal');
        }

        function updateUser() {
            if (!currentEditingItem) return;

            const formData = {
                name: document.getElementById('editUserName').value,
                email: document.getElementById('editUserEmail').value,
                phone: document.getElementById('editUserPhone').value,
                role: document.getElementById('editUserRole').value,
                status: document.getElementById('editUserStatus').value
            };

            // Validation
            if (!formData.name || !formData.email) {
                showToast('Please fill in all required fields.', 'error');
                return;
            }

            showLoading(true);
            setTimeout(() => {
                const userIndex = appData.users.findIndex(u => u.id === currentEditingItem.id);
                if (userIndex >= 0) {
                    appData.users[userIndex] = { ...currentEditingItem, ...formData };
                    saveData();
                }
                showLoading(false);
                showToast(`User "${formData.name}" has been updated.`);
                closeModal('editUserModal');
                loadScreen('users');
                currentEditingItem = null;
            }, 800);
        }

        function viewUser(userId) {
            const user = appData.users.find(u => u.id === userId);
            if (!user) return;

            document.getElementById('userDetailsContent').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>Personal Information</h4>
                        <p><strong>Full Name:</strong> ${user.name}</p>
                        <p><strong>Email:</strong> ${user.email}</p>
                        <p><strong>Phone:</strong> ${user.phone}</p>
                        <p><strong>Role:</strong> ${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</p>
                        <p><strong>Status:</strong> 
                            <span class="status-badge ${user.status}">${user.status}</span>
                        </p>
                    </div>
                    <div>
                        <h4>Account Details</h4>
                        <p><strong>User ID:</strong> #${String(user.id).padStart(5, '0')}</p>
                        <p><strong>Created:</strong> ${formatDate(user.created)}</p>
                        <p><strong>Last Login:</strong> ${formatDate(user.lastLogin)}</p>
                        <p><strong>Account Type:</strong> ${user.role === 'admin' ? 'Administrator' : user.role === 'staff' ? 'Staff Member' : 'External Agent'}</p>
                    </div>
                </div>
            `;
            openModal('viewUserModal');
        }

        function createUser() {
            const form = document.getElementById('createUserForm');
            const formData = new FormData(form);
            
            const userData = {
                id: generateId(),
                name: formData.get('fullName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                role: formData.get('role'),
                status: 'active',
                created: new Date().toISOString(),
                lastLogin: null
            };

            // Validation
            if (!userData.name || !userData.email || !userData.role) {
                showToast('Please fill in all required fields.', 'error');
                return;
            }

            // Check for duplicate email
            if (appData.users.find(u => u.email === userData.email)) {
                showToast('A user with this email already exists.', 'error');
                return;
            }

            showLoading(true);
            setTimeout(() => {
                appData.users.push(userData);
                saveData();
                showLoading(false);
                showToast(`User "${userData.name}" has been created successfully.`);
                closeModal('createUserModal');
                form.reset();
                loadScreen('users');
            }, 1000);
        }

        // Employee Operations
        function viewEmployee(employeeId) {
            const employee = appData.employees.find(e => e.id === employeeId);
            if (!employee) return;

            document.getElementById('employeeDetailsContent').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>Personal Information</h4>
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="width: 100px; height: 100px; border-radius: 50%; background: #ddd; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                <i class="material-icons" style="font-size: 48px; color: #666;">person</i>
                            </div>
                        </div>
                        <p><strong>Full Name:</strong> ${employee.name}</p>
                        <p><strong>Passport:</strong> ${employee.passport}</p>
                        <p><strong>Nationality:</strong> ${employee.nationality}</p>
                        <p><strong>Position:</strong> ${employee.position}</p>
                        <p><strong>Email:</strong> ${employee.email}</p>
                        <p><strong>Phone:</strong> ${employee.phone}</p>
                    </div>
                    <div>
                        <h4>Job Information</h4>
                        <p><strong>Job:</strong> ${employee.job}</p>
                        <p><strong>Current Status:</strong> 
                            <span class="status-badge ${employee.status}">${employee.status}</span>
                        </p>
                        <p><strong>Employee ID:</strong> #${String(employee.id).padStart(5, '0')}</p>
                        
                        <h4 style="margin-top: 20px;">Processing Status</h4>
                        <div style="margin-top: 12px;">
                            ${employee.status === 'pending' ? 
                                '<div style="color: #ff9800;"> Application pending review</div>' :
                              employee.status === 'submitted' ? 
                                '<div style="color: #2196f3;"> Submitted to government</div>' :
                              employee.status === 'approved' ? 
                                '<div style="color: #4caf50;"> Visa approved</div>' :
                                '<div style="color: #f44336;"> Application rejected</div>'
                            }
                        </div>
                    </div>
                </div>
            `;
            openModal('employeeDetailsModal');
        }

        function deleteEmployee(employeeId) {
            const employee = appData.employees.find(e => e.id === employeeId);
            if (!employee) return;

            showConfirmDialog(
                `Delete employee "${employee.name}"?`,
                'This will remove all associated forms and documents.',
                () => {
                    showLoading(true);
                    setTimeout(() => {
                        appData.employees = appData.employees.filter(e => e.id !== employeeId);
                        saveData();
                        showLoading(false);
                        showToast(`Employee "${employee.name}" has been deleted.`);
                        loadScreen('employees');
                    }, 800);
                }
            );
        }

        // Form Operations
        function previewForm(formId) {
            const form = appData.forms.find(f => f.id === formId);
            if (!form) return;

            document.querySelector('#formPreviewModal .modal-title').textContent = `${form.name} - Preview`;
            
            // Simulate form rendering
            const renderedForm = `
                <div class="form-grid" style="margin-top: 20px;">
                    <div class="form-group">
                        <label class="form-label">Full Name *</label>
                        <input type="text" class="form-control" placeholder="Enter full name" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Passport Number *</label>
                        <input type="text" class="form-control" placeholder="Enter passport number" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date of Birth *</label>
                        <input type="date" class="form-control" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nationality *</label>
                        <select class="form-control" disabled>
                            <option>Select nationality</option>
                        </select>
                    </div>
                </div>
                <p style="margin-top: 16px; color: #666; font-size: 14px;">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle;">info</i>
                    This is a preview of how the form will appear. Total fields: ${form.fields}
                </p>
            `;

            const jsonSchema = `
{
  "title": "${form.name}",
  "type": "object",
  "properties": {
    "fullName": {
      "type": "string",
      "title": "Full Name",
      "minLength": 1
    },
    "passportNumber": {
      "type": "string",
      "title": "Passport Number",
      "pattern": "^[A-Z0-9]+$"
    },
    "dateOfBirth": {
      "type": "string",
      "format": "date",
      "title": "Date of Birth"
    },
    "nationality": {
      "type": "string",
      "title": "Nationality",
      "enum": ["US", "UK", "CA", "AU"]
    }
  },
  "required": ["fullName", "passportNumber", "dateOfBirth", "nationality"]
}
            `;

            document.getElementById('formPreviewContent').innerHTML = renderedForm;
            
            // Set up tab switching
            window.currentFormPreview = {
                rendered: renderedForm,
                json: `<div class="preview-pane">${jsonSchema}</div>`
            };
            
            openModal('formPreviewModal');
        }

        function switchPreviewTab(tab) {
            const tabs = document.querySelectorAll('#formPreviewModal .tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (window.currentFormPreview) {
                document.getElementById('formPreviewContent').innerHTML = window.currentFormPreview[tab];
            }
        }

        function deleteForm(formId) {
            const form = appData.forms.find(f => f.id === formId);
            if (!form) return;

            showConfirmDialog(
                `Delete form "${form.name}"?`,
                'This form will be removed from all templates that use it.',
                () => {
                    showLoading(true);
                    setTimeout(() => {
                        appData.forms = appData.forms.filter(f => f.id !== formId);
                        saveData();
                        showLoading(false);
                        showToast(`Form "${form.name}" has been deleted.`);
                        loadScreen('forms');
                    }, 800);
                }
            );
        }

        // Assignment Operations
        function viewAssignmentDetails(assignmentId) {
            const assignment = appData.assignments.find(a => a.id === assignmentId);
            if (!assignment) return;

            document.getElementById('assignmentDetailsContent').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>Assignment Details</h4>
                        <p><strong>Staff Member:</strong> ${assignment.staff}</p>
                        <p><strong>Date:</strong> ${assignment.date}</p>
                        <p><strong>Time:</strong> ${assignment.time}</p>
                        <p><strong>Office:</strong> ${assignment.office}</p>
                        <p><strong>Status:</strong> 
                            <span class="status-badge ${assignment.status === 'scheduled' ? 'pending' : assignment.status}">
                                ${assignment.status}
                            </span>
                        </p>
                    </div>
                    <div>
                        <h4>Employees (${assignment.employees})</h4>
                        <div style="max-height: 200px; overflow-y: auto;">
                            ${assignment.employeeList.map(emp => `
                                <div style="padding: 8px; background: #f5f5f5; margin-bottom: 4px; border-radius: 4px;">
                                    <i class="material-icons" style="font-size: 16px; vertical-align: middle;">person</i>
                                    ${emp}
                                </div>
                            `).join('')}
                        </div>
                        
                        <h4 style="margin-top: 20px;">Instructions</h4>
                        <p style="background: #f9f9f9; padding: 12px; border-radius: 6px; font-size: 14px;">
                            ${assignment.instructions}
                        </p>
                    </div>
                </div>
            `;
            openModal('assignmentDetailsModal');
        }

        function updateAssignmentStatus() {
            showToast('Assignment status updated successfully!');
            closeModal('assignmentDetailsModal');
            loadScreen('assignments');
        }

        // Bulk Operations
        function openBulkActions() {
            if (selectedItems.length === 0) {
                showToast('Please select items first.', 'warning');
                return;
            }
            
            document.getElementById('bulkSelectedCount').textContent = selectedItems.length;
            document.getElementById('bulkActionType').value = '';
            document.getElementById('bulkActionOptions').innerHTML = '';
            openModal('bulkActionsModal');
        }

        function executeBulkAction() {
            const actionType = document.getElementById('bulkActionType').value;
            if (!actionType) {
                showToast('Please select an action.', 'warning');
                return;
            }

            const count = selectedItems.length;
            let message = '';

            switch(actionType) {
                case 'delete':
                    showConfirmDialog(
                        `Delete ${count} selected items?`,
                        'This action cannot be undone.',
                        () => {
                            showLoading(true);
                            setTimeout(() => {
                                // Simulate bulk delete
                                showLoading(false);
                                showToast(`${count} items deleted successfully.`);
                                closeModal('bulkActionsModal');
                                selectedItems = [];
                                loadScreen(currentScreen);
                            }, 1500);
                        },
                        'Delete'
                    );
                    return;
                case 'status':
                    message = `Status updated for ${count} items.`;
                    break;
                case 'export':
                    message = `${count} items exported successfully.`;
                    break;
                case 'assign':
                    message = `${count} items assigned to staff.`;
                    break;
                default:
                    message = `Bulk action completed for ${count} items.`;
            }

            showLoading(true);
            setTimeout(() => {
                showLoading(false);
                showToast(message);
                closeModal('bulkActionsModal');
                selectedItems = [];
                loadScreen(currentScreen);
            }, 1200);
        }

        // File Upload Simulation
        function simulateFileUpload(fileType = 'employees') {
            openModal('uploadProgressModal');
            
            let progress = 0;
            const progressBar = document.getElementById('uploadProgressBar');
            const progressText = document.getElementById('uploadProgressText');
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '% Complete';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // Show results
                    document.getElementById('uploadResults').innerHTML = `
                        <div style="text-align: center;">
                            <i class="material-icons" style="font-size: 48px; color: #4caf50;">check_circle</i>
                            <h4 style="margin: 12px 0;">Upload Successful!</h4>
                            <p>Processed ${fileType === 'employees' ? '10 employee records' : '1 form schema'}</p>
                            <div style="margin-top: 16px; padding: 12px; background: #e8f5e9; border-radius: 6px; text-align: left;">
                                <strong>Summary:</strong><br>
                                 ${fileType === 'employees' ? 'Documents extracted: 30 files' : 'Schema validated successfully'}<br>
                                 ${fileType === 'employees' ? 'Employee data parsed: 10 records' : 'Form fields: 15'}<br>
                                 ${fileType === 'employees' ? 'Photos processed: 10 images' : 'Validation rules: 8'}
                            </div>
                        </div>
                    `;
                    document.getElementById('uploadResults').style.display = 'block';
                    document.getElementById('uploadProgressFooter').style.display = 'flex';
                }
            }, 200);
        }

        function processUploadedData() {
            showToast('Data processed and imported successfully!');
            closeModal('uploadProgressModal');
            loadScreen(currentScreen);
        }

        // Export Functions
        function exportData(type = 'users') {
            showLoading(true);
            setTimeout(() => {
                showLoading(false);
                showToast(`${type.charAt(0).toUpperCase() + type.slice(1)} data exported successfully!`);
                
                // Simulate file download
                const link = document.createElement('a');
                link.href = 'data:text/csv;charset=utf-8,Sample Export Data';
                link.download = `${type}_export_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
            }, 1000);
        }

        // Print Functions
        function printPDF(employeeId) {
            showLoading(true);
            setTimeout(() => {
                showLoading(false);
                showToast('PDF generated and sent to printer queue.');
                
                // Simulate opening print dialog
                window.print();
            }, 800);
        }

        // Navigation configurations by role
        const navigationConfig = {
            admin: [
                { id: 'dashboard', label: 'Dashboard', icon: 'dashboard' },
                { id: 'users', label: 'User Management', icon: 'people' },
                { id: 'forms', label: 'Forms Management', icon: 'description' },
                { id: 'templates', label: 'Templates', icon: 'layers' },
                { id: 'jobs', label: 'Jobs Overview', icon: 'work' },
                { id: 'assignments', label: 'Assignments', icon: 'assignment' },
                { id: 'audit', label: 'Audit Logs', icon: 'history' }
            ],
            staff: [
                { id: 'dashboard', label: 'Dashboard', icon: 'dashboard' },
                { id: 'jobs', label: 'Job Management', icon: 'work' },
                { id: 'employees', label: 'Employee Management', icon: 'badge' },
                { id: 'forms-fill', label: 'Fill Forms', icon: 'edit_note' },
                { id: 'pdf', label: 'PDF Generation', icon: 'picture_as_pdf' },
                { id: 'assignments', label: 'My Assignments', icon: 'assignment' },
                { id: 'status', label: 'Status Updates', icon: 'update' }
            ],
            agent: [
                { id: 'dashboard', label: 'Dashboard', icon: 'dashboard' },
                { id: 'job-status', label: 'Job Status', icon: 'work' },
                { id: 'employee-status', label: 'Employee Status', icon: 'badge' }
            ]
        };

        // Login function
        function login(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple demo authentication
            if (username === 'admin' && password === 'admin123') {
                currentUser = { name: 'John Admin', role: 'admin', email: 'admin@laborwork.com' };
            } else if (username === 'staff' && password === 'staff123') {
                currentUser = { name: 'Sarah Staff', role: 'staff', email: 'sarah@laborwork.com' };
            } else if (username === 'agent' && password === 'agent123') {
                currentUser = { name: 'TechCorp Agent', role: 'agent', email: 'agent@techcorp.com' };
            } else {
                alert('Invalid credentials. Please try again.');
                return;
            }

            // Store user in localStorage
            localStorage.setItem('currentUser', JSON.stringify(currentUser));

            // Show main app
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('mainApp').classList.add('active');

            // Initialize app
            initializeApp();
        }

        // Initialize application
        function initializeApp() {
            // Load saved data
            loadData();
            
            // Update user info in sidebar
            document.getElementById('currentUserName').textContent = currentUser.name;
            document.getElementById('currentUserRole').textContent = 
                currentUser.role === 'admin' ? 'Administrator' : 
                currentUser.role === 'staff' ? 'Staff Member' : 'Agent';

            // Build navigation based on role
            buildNavigation();

            // Load dashboard
            loadScreen('dashboard');
        }

        // Build navigation menu
        function buildNavigation() {
            const nav = document.getElementById('sidebarNav');
            nav.innerHTML = '';

            const items = navigationConfig[currentUser.role];
            items.forEach(item => {
                const navItem = document.createElement('a');
                navItem.className = 'nav-item';
                navItem.href = '#';
                navItem.onclick = (e) => {
                    e.preventDefault();
                    loadScreen(item.id);
                };
                navItem.innerHTML = `
                    <i class="material-icons">${item.icon}</i>
                    <span>${item.label}</span>
                `;
                nav.appendChild(navItem);
            });
        }

        // Load screen content
        function loadScreen(screenId) {
            currentScreen = screenId;

            // Update active nav item
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                const items = navigationConfig[currentUser.role];
                if (items[index] && items[index].id === screenId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });

            // Close mobile menu if open
            document.getElementById('sidebar').classList.remove('open');

            // Load content based on screen
            const contentArea = document.getElementById('contentArea');
            
            switch(screenId) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'users':
                    loadUserManagement();
                    break;
                case 'forms':
                    loadFormsManagement();
                    break;
                case 'templates':
                    loadTemplates();
                    break;
                case 'jobs':
                    loadJobs();
                    break;
                case 'employees':
                    loadEmployees();
                    break;
                case 'forms-fill':
                    loadFormFilling();
                    break;
                case 'pdf':
                    loadPDFGeneration();
                    break;
                case 'assignments':
                    loadAssignments();
                    break;
                case 'status':
                    loadStatusUpdates();
                    break;
                case 'job-status':
                    loadJobStatus();
                    break;
                case 'employee-status':
                    loadEmployeeStatus();
                    break;
                case 'audit':
                    loadAuditLogs();
                    break;
                default:
                    contentArea.innerHTML = '<p>Screen not found</p>';
            }
        }

        // Dashboard screens by role
        function loadDashboard() {
            const contentArea = document.getElementById('contentArea');
            
            if (currentUser.role === 'admin') {
                contentArea.innerHTML = `
                    <div class="header">
                        <h1 class="page-title">Dashboard</h1>
                        <div class="header-actions">
                            <span style="color: #666;">Welcome back, ${currentUser.name}</span>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon blue">
                                <i class="material-icons">people</i>
                            </div>
                            <div class="stat-content">
                                <h3>12</h3>
                                <p>Total Users</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon yellow">
                                <i class="material-icons">work</i>
                            </div>
                            <div class="stat-content">
                                <h3>24</h3>
                                <p>Active Jobs</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green">
                                <i class="material-icons">layers</i>
                            </div>
                            <div class="stat-content">
                                <h3>8</h3>
                                <p>Templates</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon red">
                                <i class="material-icons">pending_actions</i>
                            </div>
                            <div class="stat-content">
                                <h3>156</h3>
                                <p>Pending Actions</p>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Recent Activity</h2>
                            <button class="btn btn-secondary" onclick="loadScreen('audit')">View All</button>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>10 mins ago</td>
                                    <td>Sarah Staff</td>
                                    <td>Created Job</td>
                                    <td>TechCorp Visa Processing - 15 employees</td>
                                </tr>
                                <tr>
                                    <td>1 hour ago</td>
                                    <td>Mike Staff</td>
                                    <td>Updated Status</td>
                                    <td>5 employees marked as submitted</td>
                                </tr>
                                <tr>
                                    <td>2 hours ago</td>
                                    <td>System</td>
                                    <td>PDF Generated</td>
                                    <td>Batch generation completed - 20 PDFs</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">System Alerts</h2>
                        </div>
                        <div style="padding: 16px; background: #fff8dc; border-radius: 6px; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="material-icons" style="color: #ff9800;">warning</i>
                                <div>
                                    <div style="font-weight: 500;">5 assignments due tomorrow</div>
                                    <div style="font-size: 14px; color: #666;">Staff members need to visit government offices</div>
                                </div>
                            </div>
                        </div>
                        <div style="padding: 16px; background: #e8f5e9; border-radius: 6px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="material-icons" style="color: #4caf50;">check_circle</i>
                                <div>
                                    <div style="font-weight: 500;">System backup completed</div>
                                    <div style="font-size: 14px; color: #666;">Daily backup finished successfully at 3:00 AM</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentUser.role === 'staff') {
                contentArea.innerHTML = `
                    <div class="header">
                        <h1 class="page-title">My Dashboard</h1>
                        <div class="header-actions">
                            <button class="btn btn-primary" onclick="openModal('createJobModal')">
                                <i class="material-icons">add</i>
                                Create Job
                            </button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon yellow">
                                <i class="material-icons">assignment</i>
                            </div>
                            <div class="stat-content">
                                <h3>8</h3>
                                <p>My Assignments</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon blue">
                                <i class="material-icons">pending</i>
                            </div>
                            <div class="stat-content">
                                <h3>23</h3>
                                <p>Forms to Fill</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green">
                                <i class="material-icons">task_alt</i>
                            </div>
                            <div class="stat-content">
                                <h3>45</h3>
                                <p>Completed Today</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon red">
                                <i class="material-icons">schedule</i>
                            </div>
                            <div class="stat-content">
                                <h3>2</h3>
                                <p>Due Today</p>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Today's Assignments</h2>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Office</th>
                                    <th>Employees</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>09:00 AM</td>
                                    <td>North Government Office</td>
                                    <td>5 employees</td>
                                    <td><span class="status-badge pending">Pending</span></td>
                                    <td>
                                        <button class="btn btn-secondary">View Details</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>02:00 PM</td>
                                    <td>South Government Office</td>
                                    <td>3 employees</td>
                                    <td><span class="status-badge pending">Pending</span></td>
                                    <td>
                                        <button class="btn btn-secondary">View Details</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">My Active Jobs</h2>
                            <a href="#" onclick="loadScreen('jobs')" style="color: #666;">View All</a>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Job Name</th>
                                    <th>Agent</th>
                                    <th>Progress</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>TechCorp Visa Processing</td>
                                    <td>TechCorp Solutions</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 65%"></div>
                                        </div>
                                        <small>65% Complete</small>
                                    </td>
                                    <td><span class="status-badge in-progress">In Progress</span></td>
                                </tr>
                                <tr>
                                    <td>Global Industries Renewal</td>
                                    <td>Global Industries</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 30%"></div>
                                        </div>
                                        <small>30% Complete</small>
                                    </td>
                                    <td><span class="status-badge in-progress">In Progress</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            } else if (currentUser.role === 'agent') {
                contentArea.innerHTML = `
                    <div class="header">
                        <h1 class="page-title">Job Overview</h1>
                        <div class="header-actions">
                            <span style="color: #666;">Last updated: 5 minutes ago</span>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon yellow">
                                <i class="material-icons">work</i>
                            </div>
                            <div class="stat-content">
                                <h3>3</h3>
                                <p>Total Jobs</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon blue">
                                <i class="material-icons">people</i>
                            </div>
                            <div class="stat-content">
                                <h3>28</h3>
                                <p>Total Employees</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green">
                                <i class="material-icons">check_circle</i>
                            </div>
                            <div class="stat-content">
                                <h3>12</h3>
                                <p>Approved</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon red">
                                <i class="material-icons">pending</i>
                            </div>
                            <div class="stat-content">
                                <h3>16</h3>
                                <p>In Process</p>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">My Jobs</h2>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Job Name</th>
                                    <th>Template</th>
                                    <th>Employees</th>
                                    <th>Progress</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>TechCorp Visa Processing</td>
                                    <td>Employment Chain</td>
                                    <td>15</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 65%"></div>
                                        </div>
                                        <small>65% Complete</small>
                                    </td>
                                    <td><span class="status-badge in-progress">In Progress</span></td>
                                </tr>
                                <tr>
                                    <td>TechCorp Q2 Renewals</td>
                                    <td>Renewal Process</td>
                                    <td>8</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 30%"></div>
                                        </div>
                                        <small>30% Complete</small>
                                    </td>
                                    <td><span class="status-badge pending">Pending</span></td>
                                </tr>
                                <tr>
                                    <td>TechCorp New Hires Jan</td>
                                    <td>Employment Chain</td>
                                    <td>5</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 100%"></div>
                                        </div>
                                        <small>100% Complete</small>
                                    </td>
                                    <td><span class="status-badge completed">Completed</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Employee Status Distribution</h2>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                            <div style="text-align: center; padding: 20px; background: #f5f5f5; border-radius: 8px;">
                                <div style="font-size: 32px; font-weight: 500; color: #ff9800;">8</div>
                                <div style="color: #666;">Pending</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: #f5f5f5; border-radius: 8px;">
                                <div style="font-size: 32px; font-weight: 500; color: #2196f3;">6</div>
                                <div style="color: #666;">Submitted</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: #f5f5f5; border-radius: 8px;">
                                <div style="font-size: 32px; font-weight: 500; color: #ff5722;">2</div>
                                <div style="color: #666;">Missing Info</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: #f5f5f5; border-radius: 8px;">
                                <div style="font-size: 32px; font-weight: 500; color: #4caf50;">12</div>
                                <div style="color: #666;">Approved</div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // User Management Screen
        function loadUserManagement() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">User Management</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="simulateFileUpload('users')">
                            <i class="material-icons">upload</i>
                            Bulk Import
                        </button>
                        <button class="btn btn-secondary" onclick="exportData('users')">
                            <i class="material-icons">download</i>
                            Export
                        </button>
                        <button class="btn btn-primary" onclick="openModal('createUserModal')">
                            <i class="material-icons">add</i>
                            Create User
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="bulk-actions">
                        <div>
                            <span id="bulkSelectedCount">0</span> users selected
                        </div>
                        <div>
                            <button class="btn btn-secondary" onclick="openBulkActions()">Bulk Actions</button>
                            <button class="btn btn-secondary" onclick="selectedItems = []; updateBulkActions(); loadScreen('users')">Clear Selection</button>
                        </div>
                    </div>

                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search users..." oninput="filterTable(this.value)">
                        <select class="form-control" style="width: 200px;" onchange="filterTable('', 'role', this.value)">
                            <option value="">All Roles</option>
                            <option value="admin">Administrator</option>
                            <option value="staff">Staff</option>
                            <option value="agent">Agent</option>
                        </select>
                        <select class="form-control" style="width: 150px;" onchange="filterTable('', 'status', this.value)">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox" onchange="toggleSelectAll(this)">
                                </th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Last Login</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${appData.users.map(user => `
                                <tr>
                                    <td><input type="checkbox" data-id="${user.id}" onchange="toggleRowSelection(this); updateBulkActions()"></td>
                                    <td><a href="#" onclick="viewUser(${user.id})" style="color: var(--labor-dark); text-decoration: none;">${user.name}</a></td>
                                    <td>${user.email}</td>
                                    <td>${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</td>
                                    <td>
                                        <span class="status-badge ${user.status}">${user.status}</span>
                                    </td>
                                    <td>${user.lastLogin ? formatDate(user.lastLogin) : 'Never'}</td>
                                    <td>
                                        <div class="table-actions">
                                            <button class="btn btn-icon" title="View Details" onclick="viewUser(${user.id})">
                                                <i class="material-icons">visibility</i>
                                            </button>
                                            <button class="btn btn-icon" title="Edit" onclick="editUser(${user.id})">
                                                <i class="material-icons">edit</i>
                                            </button>
                                            <button class="btn btn-icon" title="Delete" onclick="deleteUser(${user.id})" ${user.id === 1 ? 'disabled style="opacity: 0.5;"' : ''}>
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div style="margin-top: 20px; padding: 16px; background: #f9f9f9; border-radius: 6px; display: flex; justify-content: between; align-items: center;">
                        <span>Total: ${appData.users.length} users</span>
                        <div style="margin-left: auto;">
                            <button class="btn btn-secondary">Previous</button>
                            <span style="margin: 0 12px;">Page 1 of 1</span>
                            <button class="btn btn-secondary">Next</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Forms Management Screen
        function loadFormsManagement() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Forms Management</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="exportData('forms')">
                            <i class="material-icons">download</i>
                            Export Forms
                        </button>
                        <button class="btn btn-primary" onclick="simulateFileUpload('forms')">
                            <i class="material-icons">upload</i>
                            Upload JSON Form
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search forms..." oninput="filterTable(this.value)">
                        <select class="form-control" style="width: 150px;" onchange="filterTable('', 'status', this.value)">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Form Name</th>
                                <th>Description</th>
                                <th>Fields</th>
                                <th>Version</th>
                                <th>Status</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${appData.forms.map(form => `
                                <tr>
                                    <td><a href="#" onclick="previewForm(${form.id})" style="color: var(--labor-dark); text-decoration: none;">${form.name}</a></td>
                                    <td>${form.description}</td>
                                    <td>${form.fields} fields</td>
                                    <td>v${form.version}</td>
                                    <td>
                                        <span class="status-badge ${form.status}">${form.status}</span>
                                    </td>
                                    <td>${form.created}</td>
                                    <td>
                                        <div class="table-actions">
                                            <button class="btn btn-secondary" onclick="previewForm(${form.id})">Preview</button>
                                            <button class="btn btn-icon" title="Edit" onclick="showToast('Edit form functionality would open form builder.', 'info')">
                                                <i class="material-icons">edit</i>
                                            </button>
                                            <button class="btn btn-icon" title="Delete" onclick="deleteForm(${form.id})">
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div style="margin-top: 20px; padding: 16px; background: #f9f9f9; border-radius: 6px;">
                        <span>Total: ${appData.forms.length} forms</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Upload New Form</h2>
                    </div>
                    <div class="upload-area" onclick="simulateFileUpload('forms')">
                        <i class="material-icons upload-icon">description</i>
                        <h3>Upload JSON Schema</h3>
                        <p style="color: #666;">Drag and drop JSON file here or click to browse</p>
                        <p style="font-size: 12px; color: #999;">Only .json files are accepted</p>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 16px; background: #fff8dc; border-radius: 6px;">
                        <h4 style="margin-bottom: 12px;"> Sample JSON Schema Structure</h4>
                        <div class="preview-pane" style="font-size: 11px;">
{
  "title": "Employee Information Form",
  "type": "object",
  "properties": {
    "fullName": {
      "type": "string",
      "title": "Full Name",
      "minLength": 1
    },
    "passportNumber": {
      "type": "string", 
      "title": "Passport Number"
    }
  },
  "required": ["fullName", "passportNumber"]
}
                        </div>
                    </div>
                </div>
            `;
        }

        // Templates Screen
        function loadTemplates() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Templates</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary">
                            <i class="material-icons">add</i>
                            Create Template
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search templates...">
                        <select class="form-control" style="width: 200px;">
                            <option value="">All Agents</option>
                            <option value="1">TechCorp Solutions</option>
                            <option value="2">Global Industries</option>
                            <option value="3">Metro Services</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Template Name</th>
                                <th>Forms</th>
                                <th>Agent</th>
                                <th>Status</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.templates.map(template => `
                                <tr>
                                    <td>${template.name}</td>
                                    <td>${template.forms.length} forms</td>
                                    <td>${template.agent}</td>
                                    <td>
                                        <span class="status-badge ${template.status}">${template.status}</span>
                                    </td>
                                    <td>2025-01-01</td>
                                    <td>
                                        <div class="table-actions">
                                            <button class="btn btn-secondary">Preview</button>
                                            <button class="btn btn-icon" title="Edit">
                                                <i class="material-icons">edit</i>
                                            </button>
                                            <button class="btn btn-icon" title="Delete">
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Jobs Screen
        function loadJobs() {
            const contentArea = document.getElementById('contentArea');
            const isStaff = currentUser.role === 'staff';
            
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Job Management</h1>
                    <div class="header-actions">
                        ${isStaff ? `
                            <button class="btn btn-primary" onclick="openModal('createJobModal')">
                                <i class="material-icons">add</i>
                                Create Job
                            </button>
                        ` : ''}
                    </div>
                </div>

                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search jobs...">
                        <select class="form-control" style="width: 200px;">
                            <option value="">All Agents</option>
                            <option value="1">TechCorp Solutions</option>
                            <option value="2">Global Industries</option>
                            <option value="3">Metro Services</option>
                        </select>
                        <select class="form-control" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Job ID</th>
                                <th>Job Name</th>
                                <th>Agent</th>
                                <th>Template</th>
                                <th>Employees</th>
                                <th>Status</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.jobs.map(job => `
                                <tr>
                                    <td>#${String(job.id).padStart(5, '0')}</td>
                                    <td>${job.name}</td>
                                    <td>${job.agent}</td>
                                    <td>${job.template}</td>
                                    <td>${job.employees}</td>
                                    <td>
                                        <span class="status-badge ${job.status}">${job.status.replace('-', ' ')}</span>
                                    </td>
                                    <td>${job.created}</td>
                                    <td>
                                        <div class="table-actions">
                                            <button class="btn btn-secondary" onclick="viewJobDetails(${job.id})">View</button>
                                            ${isStaff ? `
                                                <button class="btn btn-icon" title="Edit">
                                                    <i class="material-icons">edit</i>
                                                </button>
                                            ` : ''}
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Employees Screen
        function loadEmployees() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Employee Management</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="simulateFileUpload('employees')">
                            <i class="material-icons">upload</i>
                            Import Employees
                        </button>
                        <button class="btn btn-secondary" onclick="exportData('employees')">
                            <i class="material-icons">download</i>
                            Export
                        </button>
                        <button class="btn btn-primary" onclick="showToast('Add Employee functionality would open employee form.', 'info')">
                            <i class="material-icons">add</i>
                            Add Employee
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="bulk-actions">
                        <div>
                            <span id="bulkSelectedCount">0</span> employees selected
                        </div>
                        <div>
                            <button class="btn btn-secondary" onclick="openBulkActions()">Bulk Actions</button>
                            <button class="btn btn-secondary" onclick="selectedItems = []; updateBulkActions(); loadScreen('employees')">Clear Selection</button>
                        </div>
                    </div>

                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search employees..." oninput="filterTable(this.value)">
                        <select class="form-control" style="width: 200px;" onchange="filterTable('', 'job', this.value)">
                            <option value="">All Jobs</option>
                            <option value="TechCorp">TechCorp Visa Processing</option>
                            <option value="Global">Global Industries Renewal</option>
                            <option value="Metro">Metro Services New Hires</option>
                        </select>
                        <select class="form-control" style="width: 150px;" onchange="filterTable('', 'status', this.value)">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="submitted">Submitted</option>
                            <option value="approved">Approved</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox" onchange="toggleSelectAll(this)">
                                </th>
                                <th>Photo</th>
                                <th>Name</th>
                                <th>Passport</th>
                                <th>Position</th>
                                <th>Job</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${appData.employees.map(emp => `
                                <tr>
                                    <td><input type="checkbox" data-id="${emp.id}" onchange="toggleRowSelection(this); updateBulkActions()"></td>
                                    <td>
                                        <div style="width: 40px; height: 40px; border-radius: 50%; background: #ddd; display: flex; align-items: center; justify-content: center;">
                                            <i class="material-icons" style="color: #666;">person</i>
                                        </div>
                                    </td>
                                    <td><a href="#" onclick="viewEmployee(${emp.id})" style="color: var(--labor-dark); text-decoration: none;">${emp.name}</a></td>
                                    <td>${emp.passport}</td>
                                    <td>${emp.position}</td>
                                    <td>${emp.job}</td>
                                    <td>
                                        <span class="status-badge ${emp.status}">${emp.status}</span>
                                    </td>
                                    <td>
                                        <div class="table-actions">
                                            <button class="btn btn-secondary" onclick="viewEmployee(${emp.id})">View</button>
                                            <button class="btn btn-icon" title="Edit" onclick="showToast('Edit Employee functionality would open employee editor.', 'info')">
                                                <i class="material-icons">edit</i>
                                            </button>
                                            <button class="btn btn-icon" title="Delete" onclick="deleteEmployee(${emp.id})">
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div style="margin-top: 20px; display: flex; gap: 12px; align-items: center;">
                        <button class="btn btn-secondary" onclick="openBulkActions()">
                            <i class="material-icons">update</i>
                            Bulk Status Update
                        </button>
                        <button class="btn btn-secondary" onclick="exportData('employees')">
                            <i class="material-icons">download</i>
                            Export Selected
                        </button>
                        <div style="margin-left: auto; padding: 16px; background: #f9f9f9; border-radius: 6px;">
                            <span>Total: ${appData.employees.length} employees</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Form Filling Screen
        function loadFormFilling() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Fill Forms</h1>
                    <div class="header-actions">
                        <select class="form-control" style="width: 250px;">
                            <option value="">Select Job</option>
                            <option value="1">TechCorp Visa Processing</option>
                            <option value="2">Global Industries Renewal</option>
                        </select>
                    </div>
                </div>

                <div style="display: flex; gap: 20px;">
                    <!-- Employee Selection Sidebar -->
                    <div class="card" style="width: 300px; min-height: 600px;">
                        <h3 style="margin-bottom: 20px;">Select Employee</h3>
                        <div class="search-bar" style="margin-bottom: 16px;">
                            <input type="text" class="search-input" placeholder="Search employee...">
                        </div>
                        <div style="max-height: 500px; overflow-y: auto;">
                            ${demoData.employees.slice(0, 3).map((emp, index) => `
                                <div class="employee-card ${index === 0 ? 'selected' : ''}" onclick="selectEmployee(${emp.id})">
                                    <div class="employee-photo">
                                        <i class="material-icons">person</i>
                                    </div>
                                    <div style="font-weight: 500;">${emp.name}</div>
                                    <div style="font-size: 12px; color: #666;">${emp.passport}</div>
                                    <div style="margin-top: 8px;">
                                        <span class="status-badge ${emp.status}">${emp.status}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Form Content -->
                    <div class="card" style="flex: 1;">
                        <div class="tabs">
                            <div class="tab active">Paper 1 - Visa Application</div>
                            <div class="tab">Paper 2 - Employment Verification</div>
                        </div>

                        <form id="dynamicForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-control" value="Alice Johnson" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Passport Number</label>
                                    <input type="text" class="form-control" value="A1234567" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Date of Birth</label>
                                    <input type="date" class="form-control" value="1990-05-15" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Nationality</label>
                                    <select class="form-control" required>
                                        <option value="US" selected>United States</option>
                                        <option value="UK">United Kingdom</option>
                                        <option value="CN">China</option>
                                        <option value="IN">India</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Current Address</label>
                                    <input type="text" class="form-control" value="123 Main St, New York, NY" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" value="+1 234-567-8900" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" value="alice.johnson@email.com" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Visa Type</label>
                                    <select class="form-control" required>
                                        <option value="">Select Visa Type</option>
                                        <option value="work" selected>Work Visa</option>
                                        <option value="student">Student Visa</option>
                                        <option value="tourist">Tourist Visa</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Purpose of Visit</label>
                                <textarea class="form-control" rows="3" required>Employment at TechCorp Solutions as Software Engineer</textarea>
                            </div>

                            <div style="display: flex; justify-content: space-between; margin-top: 32px;">
                                <button type="button" class="btn btn-secondary">
                                    <i class="material-icons">save</i>
                                    Save Draft
                                </button>
                                <div style="display: flex; gap: 12px;">
                                    <button type="button" class="btn btn-secondary">Previous Employee</button>
                                    <button type="submit" class="btn btn-primary">Save & Next Employee</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        }

        // PDF Generation Screen
        function loadPDFGeneration() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">PDF Generation</h1>
                    <div class="header-actions">
                        <select class="form-control" style="width: 250px;">
                            <option value="">Select Job</option>
                            <option value="1">TechCorp Visa Processing</option>
                            <option value="2">Global Industries Renewal</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Select Employees for PDF Generation</h2>
                        <button class="btn btn-primary">
                            <i class="material-icons">picture_as_pdf</i>
                            Generate PDFs
                        </button>
                    </div>

                    <div class="filter-chips">
                        <div class="chip active">All Employees</div>
                        <div class="chip">Completed Forms Only</div>
                        <div class="chip">Not Generated</div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox" checked>
                                </th>
                                <th>Employee</th>
                                <th>Passport</th>
                                <th>Paper 1</th>
                                <th>Paper 2</th>
                                <th>PDF Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.employees.slice(0, 3).map(emp => `
                                <tr>
                                    <td><input type="checkbox" checked></td>
                                    <td>${emp.name}</td>
                                    <td>${emp.passport}</td>
                                    <td><span class="status-badge completed">Completed</span></td>
                                    <td><span class="status-badge completed">Completed</span></td>
                                    <td>
                                        ${emp.status === 'approved' ? 
                                            '<span class="status-badge completed">Generated</span>' : 
                                            '<span class="status-badge pending">Not Generated</span>'
                                        }
                                    </td>
                                    <td>
                                        ${emp.status === 'approved' ? 
                                            '<button class="btn btn-secondary">Download</button>' : 
                                            '<button class="btn btn-secondary">Preview</button>'
                                        }
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Generation Queue</h2>
                    </div>
                    <div class="empty-state">
                        <i class="material-icons">hourglass_empty</i>
                        <p>No PDFs in generation queue</p>
                        <p style="font-size: 14px;">Select employees and click "Generate PDFs" to start</p>
                    </div>
                </div>
            `;
        }

        // Assignments Screen
        function loadAssignments() {
            const contentArea = document.getElementById('contentArea');
            const isAdmin = currentUser.role === 'admin';
            
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">${isAdmin ? 'Assignment Management' : 'My Assignments'}</h1>
                    <div class="header-actions">
                        ${isAdmin ? `
                            <button class="btn btn-primary">
                                <i class="material-icons">add</i>
                                Create Assignment
                            </button>
                        ` : ''}
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Assignment Calendar</h2>
                        <div style="display: flex; gap: 12px; align-items: center;">
                            <button class="btn btn-icon"><i class="material-icons">chevron_left</i></button>
                            <span style="font-weight: 500;">January 2025</span>
                            <button class="btn btn-icon"><i class="material-icons">chevron_right</i></button>
                        </div>
                    </div>
                    
                    <div class="calendar-grid">
                        <div class="calendar-header">Sun</div>
                        <div class="calendar-header">Mon</div>
                        <div class="calendar-header">Tue</div>
                        <div class="calendar-header">Wed</div>
                        <div class="calendar-header">Thu</div>
                        <div class="calendar-header">Fri</div>
                        <div class="calendar-header">Sat</div>
                        
                        ${Array.from({length: 31}, (_, i) => {
                            const day = i + 1;
                            const hasAssignment = day === 19 || day === 20;
                            return `
                                <div class="calendar-day ${day === 20 ? 'selected' : ''}">
                                    <div class="calendar-day-number">${day}</div>
                                    ${hasAssignment ? `
                                        <div class="calendar-event">Gov. Office</div>
                                    ` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Assignment List</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Staff</th>
                                <th>Government Office</th>
                                <th>Employees</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.assignments.map(assignment => `
                                <tr>
                                    <td>${assignment.date}</td>
                                    <td>${assignment.time}</td>
                                    <td>${assignment.staff}</td>
                                    <td>${assignment.office}</td>
                                    <td>${assignment.employees} employees</td>
                                    <td>
                                        <span class="status-badge ${assignment.status === 'scheduled' ? 'pending' : assignment.status}">
                                            ${assignment.status}
                                        </span>
                                    </td>
                                    <td>
                                        <button class="btn btn-secondary" onclick="viewAssignmentDetails(${assignment.id})">View Details</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Status Updates Screen
        function loadStatusUpdates() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Status Updates</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary">
                            <i class="material-icons">update</i>
                            Bulk Update
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search employees...">
                        <select class="form-control" style="width: 200px;">
                            <option value="">All Jobs</option>
                            <option value="1">TechCorp Visa Processing</option>
                            <option value="2">Global Industries Renewal</option>
                        </select>
                        <select class="form-control" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="submitted">Submitted</option>
                            <option value="approved">Approved</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox">
                                </th>
                                <th>Employee</th>
                                <th>Passport</th>
                                <th>Job</th>
                                <th>Current Status</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.employees.map(emp => `
                                <tr>
                                    <td><input type="checkbox"></td>
                                    <td>${emp.name}</td>
                                    <td>${emp.passport}</td>
                                    <td>${emp.job}</td>
                                    <td>
                                        <select class="form-control" style="width: 150px;" value="${emp.status}">
                                            <option value="pending" ${emp.status === 'pending' ? 'selected' : ''}>Pending</option>
                                            <option value="submitted" ${emp.status === 'submitted' ? 'selected' : ''}>Submitted</option>
                                            <option value="missing_info" ${emp.status === 'missing_info' ? 'selected' : ''}>Missing Info</option>
                                            <option value="approved" ${emp.status === 'approved' ? 'selected' : ''}>Approved</option>
                                            <option value="rejected" ${emp.status === 'rejected' ? 'selected' : ''}>Rejected</option>
                                        </select>
                                    </td>
                                    <td>2 hours ago</td>
                                    <td>
                                        <button class="btn btn-secondary">Update</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary">
                            <i class="material-icons">save</i>
                            Save All Changes
                        </button>
                    </div>
                </div>
            `;
        }

        // Job Status Screen (Agent)
        function loadJobStatus() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Job Status</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary">
                            <i class="material-icons">download</i>
                            Export Report
                        </button>
                    </div>
                </div>

                <div class="card">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Job Name</th>
                                <th>Template</th>
                                <th>Total Employees</th>
                                <th>Progress</th>
                                <th>Status Breakdown</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>TechCorp Visa Processing</td>
                                <td>Employment Chain</td>
                                <td>15</td>
                                <td>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 65%"></div>
                                    </div>
                                    <small>65% Complete</small>
                                </td>
                                <td>
                                    <div style="font-size: 12px;">
                                        <span style="color: #ff9800;">Pending: 5</span> |
                                        <span style="color: #2196f3;">Submitted: 3</span> |
                                        <span style="color: #4caf50;">Approved: 7</span>
                                    </div>
                                </td>
                                <td>
                                    <button class="btn btn-secondary" onclick="viewJobDetails(1)">View Details</button>
                                </td>
                            </tr>
                            <tr>
                                <td>TechCorp Q2 Renewals</td>
                                <td>Renewal Process</td>
                                <td>8</td>
                                <td>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 30%"></div>
                                    </div>
                                    <small>30% Complete</small>
                                </td>
                                <td>
                                    <div style="font-size: 12px;">
                                        <span style="color: #ff9800;">Pending: 6</span> |
                                        <span style="color: #2196f3;">Submitted: 2</span> |
                                        <span style="color: #4caf50;">Approved: 0</span>
                                    </div>
                                </td>
                                <td>
                                    <button class="btn btn-secondary" onclick="viewJobDetails(2)">View Details</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Processing Timeline</h2>
                    </div>
                    <div style="padding: 20px;">
                        ${['Job Created', 'Forms Filled', 'PDFs Generated', 'Submitted to Government', 'Awaiting Response', 'Completed'].map((step, index) => `
                            <div style="display: flex; align-items: center; margin-bottom: 20px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: ${index < 4 ? '#4caf50' : '#ddd'}; color: white; display: flex; align-items: center; justify-content: center; font-weight: 500;">
                                    ${index < 4 ? '<i class="material-icons">check</i>' : index + 1}
                                </div>
                                <div style="margin-left: 16px;">
                                    <div style="font-weight: 500;">${step}</div>
                                    <div style="font-size: 12px; color: #666;">${index < 4 ? 'Completed' : 'Pending'}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Employee Status Screen (Agent)
        function loadEmployeeStatus() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Employee Status</h1>
                    <div class="header-actions">
                        <select class="form-control" style="width: 250px;">
                            <option value="">All Jobs</option>
                            <option value="1">TechCorp Visa Processing</option>
                            <option value="2">TechCorp Q2 Renewals</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="filter-chips">
                        <div class="chip active">All Status</div>
                        <div class="chip">Pending</div>
                        <div class="chip">Submitted</div>
                        <div class="chip">Approved</div>
                        <div class="chip">Rejected</div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Employee Name</th>
                                <th>Passport</th>
                                <th>Job</th>
                                <th>Status</th>
                                <th>Last Updated</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${demoData.employees.map(emp => `
                                <tr>
                                    <td>${emp.name}</td>
                                    <td>${emp.passport}</td>
                                    <td>${emp.job}</td>
                                    <td>
                                        <span class="status-badge ${emp.status}">${emp.status}</span>
                                    </td>
                                    <td>2025-01-15 10:30 AM</td>
                                    <td>
                                        ${emp.status === 'approved' ? 'Visa approved, valid until 2027' :
                                          emp.status === 'submitted' ? 'Awaiting government response' :
                                          'Forms being processed'}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Status Summary</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div style="text-align: center; padding: 20px; background: #fff8dc; border-radius: 8px;">
                            <div style="font-size: 32px; font-weight: 500; color: #ff9800;">8</div>
                            <div style="color: #666;">Pending</div>
                            <div style="font-size: 12px; color: #999; margin-top: 4px;">32%</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #e3f2fd; border-radius: 8px;">
                            <div style="font-size: 32px; font-weight: 500; color: #2196f3;">6</div>
                            <div style="color: #666;">Submitted</div>
                            <div style="font-size: 12px; color: #999; margin-top: 4px;">24%</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #ffebee; border-radius: 8px;">
                            <div style="font-size: 32px; font-weight: 500; color: #ff5722;">2</div>
                            <div style="color: #666;">Missing Info</div>
                            <div style="font-size: 12px; color: #999; margin-top: 4px;">8%</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #e8f5e9; border-radius: 8px;">
                            <div style="font-size: 32px; font-weight: 500; color: #4caf50;">9</div>
                            <div style="color: #666;">Approved</div>
                            <div style="font-size: 12px; color: #999; margin-top: 4px;">36%</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Audit Logs Screen
        function loadAuditLogs() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div class="header">
                    <h1 class="page-title">Audit Logs</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary">
                            <i class="material-icons">download</i>
                            Export Logs
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="tabs">
                        <div class="tab active">Network Logs</div>
                        <div class="tab">Print Logs</div>
                        <div class="tab">User Activity</div>
                    </div>

                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search logs...">
                        <select class="form-control" style="width: 150px;">
                            <option value="">All Users</option>
                            <option value="1">John Admin</option>
                            <option value="2">Sarah Staff</option>
                            <option value="3">Mike Staff</option>
                        </select>
                        <input type="date" class="form-control" style="width: 150px;">
                        <input type="date" class="form-control" style="width: 150px;">
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Endpoint</th>
                                <th>Method</th>
                                <th>Status</th>
                                <th>IP Address</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-01-18 10:45:23</td>
                                <td>Sarah Staff</td>
                                <td>Create Job</td>
                                <td>/api/jobs</td>
                                <td><span style="color: #4caf50;">POST</span></td>
                                <td><span style="color: #4caf50;">200</span></td>
                                <td>192.168.1.105</td>
                            </tr>
                            <tr>
                                <td>2025-01-18 10:42:15</td>
                                <td>John Admin</td>
                                <td>Update User</td>
                                <td>/api/users/5</td>
                                <td><span style="color: #ff9800;">PUT</span></td>
                                <td><span style="color: #4caf50;">200</span></td>
                                <td>192.168.1.101</td>
                            </tr>
                            <tr>
                                <td>2025-01-18 10:38:45</td>
                                <td>Mike Staff</td>
                                <td>Generate PDF</td>
                                <td>/api/pdf/generate</td>
                                <td><span style="color: #4caf50;">POST</span></td>
                                <td><span style="color: #4caf50;">201</span></td>
                                <td>192.168.1.108</td>
                            </tr>
                            <tr>
                                <td>2025-01-18 10:35:12</td>
                                <td>System</td>
                                <td>Login Attempt</td>
                                <td>/auth/login</td>
                                <td><span style="color: #4caf50;">POST</span></td>
                                <td><span style="color: #f44336;">401</span></td>
                                <td>192.168.1.200</td>
                            </tr>
                            <tr>
                                <td>2025-01-18 10:30:00</td>
                                <td>Sarah Staff</td>
                                <td>Export Data</td>
                                <td>/api/employees/export</td>
                                <td><span style="color: #2196f3;">GET</span></td>
                                <td><span style="color: #4caf50;">200</span></td>
                                <td>192.168.1.105</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Helper Functions
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            document.getElementById('mainApp').classList.remove('active');
            document.getElementById('loginScreen').classList.add('active');
            document.getElementById('loginForm').reset();
        }

        function createUser() {
            alert('User created successfully!');
            closeModal('createUserModal');
            loadScreen('users');
        }

        function selectEmployee(employeeId) {
            document.querySelectorAll('.employee-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function viewJobDetails(jobId) {
            alert(`View details for job #${jobId}`);
        }

        // Job Creation Wizard Functions
        function jobWizardNext() {
            if (jobWizardStep < 4) {
                document.getElementById(`jobStepContent${jobWizardStep}`).style.display = 'none';
                document.getElementById(`jobStep${jobWizardStep}`).classList.remove('active');
                document.getElementById(`jobStep${jobWizardStep}`).classList.add('completed');
                
                jobWizardStep++;
                
                document.getElementById(`jobStepContent${jobWizardStep}`).style.display = 'block';
                document.getElementById(`jobStep${jobWizardStep}`).classList.add('active');
                
                if (jobWizardStep === 4) {
                    // Show summary
                    document.getElementById('jobSummary').innerHTML = `
                        <p><strong>Job Name:</strong> TechCorp Visa Processing</p>
                        <p><strong>Agent:</strong> TechCorp Solutions</p>
                        <p><strong>Template:</strong> Employment Chain Process</p>
                        <p><strong>Priority:</strong> Normal</p>
                        <p><strong>Due Date:</strong> 2025-02-01</p>
                        <p><strong>Employees:</strong> 10 employees imported</p>
                    `;
                    document.getElementById('jobWizardNext').style.display = 'none';
                    document.getElementById('jobWizardCreate').style.display = 'inline-flex';
                }
                
                document.getElementById('jobWizardBack').style.display = 'inline-flex';
            }
        }

        function jobWizardBack() {
            if (jobWizardStep > 1) {
                document.getElementById(`jobStepContent${jobWizardStep}`).style.display = 'none';
                document.getElementById(`jobStep${jobWizardStep}`).classList.remove('active');
                
                jobWizardStep--;
                
                document.getElementById(`jobStepContent${jobWizardStep}`).style.display = 'block';
                document.getElementById(`jobStep${jobWizardStep}`).classList.add('active');
                document.getElementById(`jobStep${jobWizardStep}`).classList.remove('completed');
                
                if (jobWizardStep === 1) {
                    document.getElementById('jobWizardBack').style.display = 'none';
                }
                
                if (jobWizardStep < 4) {
                    document.getElementById('jobWizardNext').style.display = 'inline-flex';
                    document.getElementById('jobWizardCreate').style.display = 'none';
                }
            }
        }

        function createJob() {
            alert('Job created successfully!');
            closeModal('createJobModal');
            loadScreen('jobs');
            // Reset wizard
            jobWizardStep = 1;
            document.querySelectorAll('.wizard-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index === 0) step.classList.add('active');
            });
            document.querySelectorAll('.wizard-content').forEach((content, index) => {
                content.style.display = index === 0 ? 'block' : 'none';
            });
        }

        // File upload handling
        document.addEventListener('DOMContentLoaded', function() {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', login);

            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('loginScreen').classList.remove('active');
                document.getElementById('mainApp').classList.add('active');
                initializeApp();
            }

            // File upload areas
            const uploadAreas = document.querySelectorAll('.upload-area');
            uploadAreas.forEach(area => {
                area.addEventListener('click', () => {
                    const input = area.querySelector('input[type="file"]') || 
                                 document.createElement('input');
                    input.type = 'file';
                    input.click();
                });

                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });

                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });

                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');
                    // Handle file drop
                    console.log('Files dropped:', e.dataTransfer.files);
                });
            });
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal-backdrop')) {
                event.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>